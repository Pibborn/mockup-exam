\documentclass[13pt, a4paper]{exam}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\renewcommand{\baselinestretch}{1.2}

\begin{document}
    \begin{center}
        % \vspace{0.4in}
        % \makebox[\textwidth]{Name:\enspace\hrulefill} \\
        % \vspace{0.5in}
        \Large\textbf{MADAS - Machine Learning - Sample Exam}
    \end{center}

\noindent Answer the theory questions and prepare a python script solving the lab problem presented below.
\\
\\
\textbf{Marks}: If you don't answer to questions labelled as "Extra" you will be rated with a grade in the range [0..26]. If you also answer the "Extra" question you will be able to receive full marks.
\\
\textbf{Allotted time}: 1h for the theory questions; 2h for the Lab exercises.
\\
\textbf{Rules}: During the theory part of the exam you are not allowed to look at reference material of any kind. During the lab part of the exam you are allowed to use all resources you can find over the internet.
\\
Interpersonal communication of any kind is strictly forbidden during the whole exam.

\begin{questions}
    \question{{\Large Theory}}

    \begin{parts}
        \part{Which are the main characteristics, advantages and shortcomings of the following clustring algorithms: partitional, hierarchical, and density based?}

        \part{Which cost function would you use in combination with sigmoid output units? Why? \textbf{Extra}: prove formally that your proposal has the advantages you claimed.}

    \end{parts}


    \question{\Large Lab Exercises}

    Complete the two Python files \verb|ex1_clustering| and \verb|ex2_classification|. Please notice that your scripts should be working by imputing the line \verb|python3 ex1_clustering| (or \verb|python3 ex2_classification|) in the Anaconda Prompt - we recommend you avoid using notebooks at this stage.

    \begin{parts}
        \part \verb|ex1_clustering.py| requires you to use the Breast Cancer dataset to train various clustering models of your choosing.
        \begin{subparts}
            \subpart Carefully read the dataset description file \verb|breast-cancer-wisconsin.names|;
            \subpart Preprocess the data;
            \subpart Train various clustering models, including at least one DBSCAN model;
            \subpart Use matplotlib to plot the NMI scores of each model;
            \subpart Optimize the $\epsilon$ parameter in DBSCAN (\verb|eps| in the scikit-learn class) to obtain the best NMI you can; please include at least 5 different possible values for this parameter.
        \end{subparts}
        \part In the \verb|ex2_classification.py| exercise, you are expected to complete a script that creates a neural network model, also training it on the breast cancer dataset.
        \begin{subparts}
            \subpart Preprocess the data (if you import the functions you have written to solve exercise 1 instead of copy/pasting them, you will be awarded extra points);
            \subpart Complete the \verb|build_loss()| function in the \verb|MyNetwork| class so that:
            \begin{enumerate}
                \item it applies the sigmoid activation function to the \verb|self.output| tensor;
                \item it computes the cross-entropy loss on the resulting output;
                \item returns the resulting tensor to its caller.
            \end{enumerate}

             You must not use the predefined Tensorflow losses (such as \verb|softmax_cross_entropy_with| \verb|_logits(...)| or similar functions);
            \subpart Complete the ``main function" (lines 23 onwards) so that it trains a multi-layer network to solve the problem described above.

            You may want to open a python session  from the command line, import the \verb|utils| module,  and use the command \verb|help(utils.MultiLayerNetwork)| to access the
            documentation of methods that you can use.
        \end{subparts}
    \end{parts}

\end{questions}


\end{document}
